<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maadhuri Shop - Authentic Indian Flavors & Organic Products</title>
    <style>
        /* Smooth Scrolling */
        html {
            scroll-behavior: smooth;
        }

        :root {
            --primary-color: #2c5f2d;
            --secondary-color: #97c97f;
            --accent-color: #ff6b35;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #f8f9fa;
            --white: #ffffff;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-hover: 0 5px 20px rgba(0,0,0,0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--bg-light);
            padding-top: 70px;
        }

        /* Navigation */
        nav {
            background: var(--white);
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: 1rem 0;
            transition: transform 0.3s ease-in-out;
        }

        nav.hidden {
            transform: translateY(-100%);
        }

        body {
            padding-top: 70px;
        }

        nav .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
            white-space: nowrap;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
            align-items: center;
            margin: 0;
            padding: 0;
            justify-content: center;
        }

        .nav-links li {
            margin: 0;
            padding: 0;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--text-dark);
            font-weight: 500;
            transition: color 0.3s;
            white-space: nowrap;
            display: inline-block;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        .nav-btn {
            background: var(--primary-color);
            color: var(--white);
            padding: 0.5rem 1.5rem;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .nav-btn:hover {
            background: #1e4620;
        }

        .cart-btn {
            position: relative;
            background: var(--accent-color);
        }

        .cart-btn:hover {
            background: #e55a28;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: red;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .menu-toggle span {
            width: 25px;
            height: 3px;
            background: var(--text-dark);
            margin: 3px 0;
            transition: 0.3s;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--white);
            text-align: center;
            padding: 6rem 2rem;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.9;
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Stats Section */
        .stats {
            background: var(--white);
            padding: 3rem 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: -3rem auto 2rem;
            max-width: 1200px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .stat-card {
            text-align: center;
            padding: 1.5rem;
        }

        .stat-card h3 {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        /* Section Headers */
        .section {
            padding: 4rem 2rem;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-header h2 {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .section-header p {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        /* Filter Section */
        .filter-section {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .filter-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 1rem;
        }

        .category-filter {
            padding: 0.8rem 1.5rem;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            background: var(--white);
            cursor: pointer;
            font-size: 1rem;
        }

        .sort-filter {
            padding: 0.8rem 1.5rem;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            background: var(--white);
            cursor: pointer;
            font-size: 1rem;
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .product-card {
            background: var(--white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-category {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .product-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .product-description {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .product-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .add-to-cart-btn {
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }

        .add-to-cart-btn:hover {
            background: #1e4620;
        }

        /* Cart Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: var(--white);
            margin: 5% auto;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 30px rgba(0,0,0,0.3);
            font-size: 1rem;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--bg-light);
        }

        .modal-header h2 {
            font-size: 1.5rem;
            margin: 0;
            color: var(--primary-color);
            font-weight: 600;
        }

        .close-btn {
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text-light);
            transition: color 0.3s;
            line-height: 1;
        }

        .close-btn:hover {
            color: var(--text-dark);
        }

        .cart-item {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid #e0e0e0;
            align-items: center;
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .cart-item-price {
            color: var(--primary-color);
            font-weight: bold;
        }

        .quantity-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            margin-top: 0.5rem;
        }

        .quantity-btn {
            background: var(--secondary-color);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        .quantity-btn:hover {
            background: var(--primary-color);
            color: var(--white);
        }

        .remove-btn {
            background: var(--accent-color);
            color: var(--white);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .remove-btn:hover {
            background: #e55a28;
        }

        .cart-summary {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 2px solid var(--primary-color);
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .checkout-btn {
            width: 100%;
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 1rem;
            border-radius: 5px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .checkout-btn:hover {
            background: #1e4620;
        }

        .empty-cart {
            text-align: center;
            padding: 2rem;
            color: var(--text-light);
        }

        /* Admin Section */
        .admin-section {
            background: var(--bg-light);
            min-height: 100vh;
            padding: 2rem;
        }

        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .admin-header {
            background: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .admin-stat-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .admin-stat-card h3 {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .admin-form {
            background: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 1rem;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: var(--white);
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-primary:hover {
            background: #1e4620;
        }

        .btn-secondary {
            background: var(--text-light);
            color: var(--white);
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .btn-secondary:hover {
            background: #6c7a7d;
        }

        .products-table {
            background: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: var(--bg-light);
            font-weight: 600;
            color: var(--text-dark);
        }

        .action-btns {
            display: flex;
            gap: 0.5rem;
        }

        .btn-edit {
            background: #3498db;
            color: var(--white);
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s;
        }

        .btn-edit:hover {
            background: #2980b9;
        }

        .btn-delete {
            background: #e74c3c;
            color: var(--white);
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s;
        }

        .btn-delete:hover {
            background: #c0392b;
        }

        /* Footer */
        footer {
            background: var(--text-dark);
            color: var(--white);
            padding: 3rem 2rem 1rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 3rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .footer-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: var(--secondary-color);
        }

        .footer-section p {
            line-height: 1.8;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .footer-section a {
            color: var(--white);
            text-decoration: none;
            opacity: 0.8;
            transition: all 0.3s;
        }

        .footer-section a:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .social-icons {
            display: flex;
            gap: 1.5rem;
            margin-top: 1rem;
            align-items: center;
        }

        .social-icons a {
            font-size: 2.5rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            opacity: 0.8;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background: var(--primary-color);
            color: var(--white);
            padding: 1rem 2rem;
            border-radius: 5px;
            box-shadow: var(--shadow-hover);
            z-index: 3000;
            animation: slideIn 0.3s;
            display: none;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification.success {
            background: #27ae60;
        }

        .notification.error {
            background: #e74c3c;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .menu-toggle {
                display: flex;
            }

            .nav-links {
                position: fixed;
                left: -100%;
                top: 70px;
                flex-direction: column;
                background: var(--white);
                width: 100%;
                text-align: center;
                transition: 0.3s;
                box-shadow: var(--shadow);
                padding: 2rem 0;
            }

            .nav-links.active {
                left: 0;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .stats {
                grid-template-columns: 1fr;
                margin: -2rem auto 2rem;
            }

            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 1rem;
            }

            .filter-controls {
                flex-direction: column;
            }

            .search-box {
                width: 100%;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
            }

            .form-actions {
                flex-direction: column;
            }

            .footer-content {
                grid-template-columns: 1fr;
            }
        }
    
        /* Weekly Recipes Section */
        .recipe-card {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            background: var(--bg-light);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-top: 2rem;
        }

        .recipe-image-container {
            position: relative;
            overflow: hidden;
        }

        .recipe-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .recipe-card:hover .recipe-image {
            transform: scale(1.05);
        }

        .recipe-content {
            padding: 2rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .recipe-content h3 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .recipe-meta {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text-light);
            flex-wrap: wrap;
        }

        .recipe-content p {
            font-size: 1.05rem;
            line-height: 1.8;
            margin-bottom: 1.5rem;
        }

        .recipe-ingredients {
            background: var(--white);
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .recipe-ingredients h4 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .recipe-ingredients p {
            margin: 0;
        }

        /* Reviews Section */
        .review-form-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .review-form-card h3 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }

        .star-rating {
            display: flex;
            gap: 0.5rem;
            font-size: 2rem;
        }

        .star {
            cursor: pointer;
            color: #ddd;
            transition: color 0.2s;
        }

        .star:hover,
        .star.active {
            color: #ffc107;
        }

        .reviews-container {
            display: grid;
            gap: 1.5rem;
        }

        .review-item {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }

        .review-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .review-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .review-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .review-info {
            flex: 1;
        }

        .review-info h4 {
            margin: 0;
            color: var(--text-dark);
            font-size: 1.1rem;
        }

        .review-stars {
            color: #ffc107;
            font-size: 1.2rem;
        }

        .review-date {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .review-text {
            color: var(--text-dark);
            line-height: 1.8;
            font-size: 1rem;
        }

        @media (max-width: 768px) {
            .recipe-card {
                grid-template-columns: 1fr;
            }

            .recipe-image-container {
                height: 250px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }

    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script></head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <a href="#" class="logo">üåø Maadhuri Shop</a>
            <div class="menu-toggle" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-links" id="navLinks">
                <li><a href="#products">Products</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#weekly-recipes">Weekly Recipe</a></li>
                <li><a href="#reviews">Reviews</a></li>
                <li><a href="#contact">Contact</a></li>
                <li><a href="#" onclick="openAdminLogin(); return false;">Admin</a></li>
            </ul>
            <button class="nav-btn cart-btn" onclick="openCart()">
                üõí Cart
                <span class="cart-count" id="cartCount">0</span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    
    <!-- Login Modal -->
    <div id="loginModal" class="modal" style="display: none; align-items: center; justify-content: center; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000;" onclick="if(event.target === this) closeLoginModal()">
        <div style="width: 100%; max-width: 400px; margin: auto;">
            <div style="background: var(--white); border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden; position: relative;">
                <div style="background: var(--primary-color); color: var(--white); padding: 1.5rem; text-align: center; position: relative;">
                    <h2 style="margin: 0; font-size: 1.5rem;">üîê Admin Login</h2>
                    <span class="close-btn" onclick="closeLoginModal()" style="position: absolute; top: 1rem; right: 1rem; color: var(--white); cursor: pointer; font-size: 1.5rem;">&times;</span>
                </div>
                <form id="loginForm" onsubmit="handleLogin(event)" style="padding: 2rem;">
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-dark);">Email/Gmail*</label>
                        <input type="email" id="loginEmail" placeholder="admin@gmail.com" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; font-family: inherit;" required>
                    </div>
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--text-dark);">Password*</label>
                        <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem; font-family: inherit;" required>
                    </div>
                    <button type="submit" style="width: 100%; padding: 0.75rem; background: var(--primary-color); color: var(--white); border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background 0.3s;">üîì Login</button>
                </form>
                <p id="loginError" style="color: #d32f2f; text-align: center; margin: 0 2rem 1rem; display: none; font-weight: 600;"></p>
            </div>
        </div>
    </div>

<div id="mainContent">
        <!-- Hero Section -->
        <section class="hero" id="home">
            <h1>üåæ AUTHENTIC FLAVORS</h1>
            <p>Traditional Spices & More</p>
            <p>Experience the rich flavors of India with our carefully curated collection of traditional spices, grains, and organic essentials for your kitchen.</p>
        </section>

        <!-- Stats Section -->
        <div class="stats">
            <div class="stat-card">
                <h3>FSSAI</h3>
                <p>Certified Safe</p>
            </div>
            
            <div class="stat-card">
                <h3>50K+</h3>
                <p>Happy Customers</p>
            </div>
            <div class="stat-card">
                <h3>500+</h3>
                <p>Premium Products</p>
            </div>
        </div>

        <!-- Products Section -->
        <section class="section" id="products">
            <div class="container">
                <div class="section-header">
                    <h2>‚≠ê PREMIUM SELECTION</h2>
                    <p>Handpicked premium organic products sourced directly from trusted farmers and traditional producers across India.</p>
                </div>

                <!-- Filter Section -->
                <div class="filter-section">
                    <div class="filter-controls">
                        <input type="text" class="search-box" id="searchBox" placeholder="üîç Search products..." onkeyup="filterProducts()">
                        <select class="category-filter" id="categoryFilter" onchange="filterProducts()">
                            <option value="all">All Categories</option>
                            <option value="spices">Spices</option>
                            <option value="grains">Grains</option>
                            <option value="organic">Organic</option>
                            <option value="pulses">Pulses</option>
                        </select>
                        <select class="sort-filter" id="sortFilter" onchange="sortProducts()">
                            <option value="default">Sort By</option>
                            <option value="name-asc">Name (A-Z)</option>
                            <option value="name-desc">Name (Z-A)</option>
                            <option value="price-asc">Price (Low to High)</option>
                            <option value="price-desc">Price (High to Low)</option>
                        </select>
                    </div>
                </div>

                <!-- Product Grid -->
                <div class="product-grid" id="productGrid">
                    <!-- Products will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section class="section" id="about" style="background: var(--white);">
            <div class="container">
                <div class="section-header">
                    <h2>About Maadhuri Shop</h2>
                    <p>Your trusted source for authentic Indian products since 2020</p>
                </div>
                <p style="text-align: center; max-width: 800px; margin: 0 auto; font-size: 1.1rem; line-height: 1.8;">
                    At Maadhuri Shop, we believe in bringing the authentic taste of India to your kitchen. Our products are sourced directly from trusted farmers and traditional producers, ensuring the highest quality and authenticity. We are committed to providing you with organic, natural, and traditional products that have been part of Indian households for generations.
                </p>
            </div>
        </section>

        <!-- Weekly Recipes Section -->
        <section class="section" id="weekly-recipes" style="background: var(--white);">
            <div class="container">
                <div class="section-header">
                    <h2>üçõ Weekly Recipe</h2>
                    <p>Discover authentic Indian recipes every week</p>
                </div>
                <div class="recipe-card" id="recipeDisplay">
                    <div class="recipe-image-container">
                        <img id="recipeImage" src="https://images.unsplash.com/photo-1585937421612-70a008356fbe?w=800&h=600&fit=crop" alt="Weekly Recipe" class="recipe-image">
                    </div>
                    <div class="recipe-content">
                        <h3 id="recipeTitle">Butter Chicken</h3>
                        <div class="recipe-meta">
                            <span>‚è±Ô∏è <span id="recipePrepTime">45 mins</span></span>
                            <span>üë• <span id="recipeServes">4 servings</span></span>
                            <span>üå∂Ô∏è <span id="recipeDifficulty">Medium</span></span>
                        </div>
                        <p id="recipeDescription">A rich and creamy North Indian curry with tender chicken pieces in a tomato-based sauce with butter and cream. Perfect with naan or rice!</p>
                        <div class="recipe-ingredients">
                            <h4>Key Ingredients:</h4>
                            <p id="recipeIngredients">Chicken, Butter, Cream, Tomatoes, Garam Masala, Ginger-Garlic Paste</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Customer Reviews Section -->
        <section class="section" id="reviews">
            <div class="container">
                <div class="section-header">
                    <h2>‚≠ê Customer Reviews</h2>
                    <p>What our customers say about us</p>
                </div>

                <!-- Write Review Form -->
                <div class="review-form-card">
                    <h3>Write a Review</h3>
                    <form id="reviewForm" onsubmit="submitReview(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="reviewName">Your Name*</label>
                                <input type="text" id="reviewName" class="form-control" required placeholder="John Doe">
                            </div>
                            <div class="form-group">
                                <label for="reviewEmail">Your Email*</label>
                                <input type="email" id="reviewEmail" class="form-control" required placeholder="john@example.com">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Rating*</label>
                            <div class="star-rating">
                                <span class="star" data-rating="1">‚òÖ</span>
                                <span class="star" data-rating="2">‚òÖ</span>
                                <span class="star" data-rating="3">‚òÖ</span>
                                <span class="star" data-rating="4">‚òÖ</span>
                                <span class="star" data-rating="5">‚òÖ</span>
                            </div>
                            <input type="hidden" id="reviewRating" required>
                        </div>

                        <div class="form-group">
                            <label for="reviewText">Your Review*</label>
                            <textarea id="reviewText" class="form-control" rows="4" required placeholder="Share your experience with our products..."></textarea>
                        </div>

                        <button type="submit" class="nav-btn" style="width: 100%;">Submit Review</button>
                    </form>
                </div>

                <!-- Reviews Display - Compact with See All -->
                <div id="reviewsSummary" style="text-align: center; margin-top: 2rem;">
                    <p style="color: var(--text-light); font-size: 1.1rem;">
                        <span id="reviewCount">0</span> customer reviews
                    </p>
                    <button class="nav-btn" onclick="toggleReviews()" style="margin-top: 1rem;" id="toggleReviewsBtn">
                        See All Reviews
                    </button>
                </div>

                <div class="reviews-container" id="reviewsContainer" style="display: none; margin-top: 2rem;">
                    <!-- Reviews will be displayed here when expanded -->
                </div>
            </div>
        </section>

<!-- Contact Section -->
        <section class="section" id="contact">
            <div class="container">
                <div class="section-header">
                    <h2>Contact Us</h2>
                    <p>Get in touch with us for any queries or bulk orders</p>
                </div>
                <div style="text-align: center; font-size: 1.1rem;">
                    <p><strong>Email:</strong> contact@maadhuri.shop</p>
                    <p><strong>Phone:</strong> +91 98765 43210</p>
                    <p><strong>Address:</strong> 123 Market Street, Mumbai, India</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-section" style="display: none;">
        <div class="admin-container">
            <div class="admin-header">
                <h1>Admin Dashboard</h1>
                <button class="btn-secondary" onclick="logoutAdmin()">Back to Shop</button>
            </div>

            <!-- Admin Stats -->
            <div class="admin-stats">
                <div class="admin-stat-card">
                    <h3 id="totalProducts">0</h3>
                    <p>Total Products</p>
                </div>
                <div class="admin-stat-card">
                    <h3 id="totalRevenue">‚Çπ0</h3>
                    <p>Total Revenue</p>
                </div>
                <div class="admin-stat-card">
                    <h3 id="totalOrders">0</h3>
                    <p>Total Orders</p>
                </div>
                <div class="admin-stat-card">
                    <h3 id="avgOrderValue">‚Çπ0</h3>
                    <p>Avg Order Value</p>
                </div>
                <div class="admin-stat-card">
                    <h3 id="pendingOrders">0</h3>
                    <p>Pending Orders</p>
                </div>
                <div class="admin-stat-card">
                    <h3 id="lowStockItems">0</h3>
                    <p>Low Stock Items</p>
                </div>
            </div>

            <!-- Add/Edit Product Form -->
            <div class="admin-form">
                <h2 id="formTitle">Add New Product</h2>
                <form id="productForm" onsubmit="saveProduct(event)">
                    <input type="hidden" id="productId">
                    <div class="form-group">
                        <label for="productName">Product Name*</label>
                        <input type="text" id="productName" required>
                    </div>
                    <div class="form-group">
                        <label for="productCategory">Category*</label>
                        <select id="productCategory" required>
                            <option value="">Select Category</option>
                            <option value="spices">Spices</option>
                            <option value="grains">Grains</option>
                            <option value="organic">Organic</option>
                            <option value="pulses">Pulses</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="productPrice">Price (‚Çπ)*</label>
                        <input type="number" id="productPrice" step="0.01" required oninput="calculateDiscountedPrice()">
                    </div>
                    <div class="form-group">
                        <label for="productDiscount">Discount (%)</label>
                        <input type="number" id="productDiscount" min="0" max="100" step="0.01" value="0" oninput="calculateDiscountedPrice()">
                        <small style="color: var(--text-light);">Enter discount percentage (0-100)</small>
                    </div>
                    <div class="form-group" id="discountedPriceDisplay" style="display: none; padding: 0.75rem; background: var(--bg-light); border-radius: 5px; margin-top: 0.5rem;">
                        <strong>Discounted Price: ‚Çπ<span id="discountedPriceValue">0.00</span></strong>
                    </div>
                    <div class="form-group">
                        <label for="productDescription">Description</label>
                        <textarea id="productDescription" placeholder="Enter product description..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="productImage">Product Image URL</label>
                        <input type="url" id="productImage" placeholder="https://example.com/image.jpg">
                    </div>
                    <div class="form-group">
                        <label for="productStock">Stock Quantity*</label>
                        <input type="number" id="productStock" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="productSKU">SKU Code</label>
                        <input type="text" id="productSKU" placeholder="e.g., TUR-001">
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">Save Product</button>
                        <button type="button" class="btn-secondary" onclick="resetForm()">Reset</button>
                    </div>
                </form>
            </div>

            <!-- Products Table -->
            <div class="products-table">
                <h2>Manage Products</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Category</th>
                            <th>Price</th>
                            <th>Stock</th>
                            <th>SKU</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Products will be dynamically loaded here -->
                    </tbody>
                </table>
            

            <!-- Weekly Recipe Editor -->
            <div class="admin-recipe-editor" style="background: var(--white); padding: 2rem; border-radius: 10px; margin-top: 2rem;">
                <h2 style="color: var(--primary-color); margin-bottom: 1rem;">üìù Edit Weekly Recipe</h2>
                <p style="color: var(--text-light); margin-bottom: 1.5rem;">Update the weekly recipe that customers see on the homepage</p>

                <form id="recipeForm" onsubmit="saveRecipe(event)" style="display: grid; gap: 1rem;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Recipe Name*</label>
                            <input type="text" id="recipeNameInput" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px;" required>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Prep Time*</label>
                            <input type="text" id="recipePrepTimeInput" placeholder="e.g., 45 mins" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px;" required>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Servings*</label>
                            <input type="text" id="recipeServesInput" placeholder="e.g., 4 servings" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px;" required>
                        </div>

                        <div>
                            <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Difficulty*</label>
                            <select id="recipeDifficultyInput" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px;" required>
                                <option value="Easy">Easy</option>
                                <option value="Medium">Medium</option>
                                <option value="Hard">Hard</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Image URL*</label>
                        <input type="url" id="recipeImageInput" placeholder="https://example.com/image.jpg" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px;" required>
                        <small style="color: var(--text-light);">Use a direct image URL</small>
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Description*</label>
                        <textarea id="recipeDescInput" rows="3" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; font-family: inherit;" required></textarea>
                    </div>

                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Key Ingredients*</label>
                        <input type="text" id="recipeIngredientsInput" placeholder="Chicken, Butter, Cream, Tomatoes" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px;" required>
                    </div>

                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <button type="submit" class="nav-btn" style="flex: 1;">üíæ Save Recipe</button>
                        <button type="button" class="btn-secondary" onclick="loadCurrentRecipe()">üîÑ Reset</button>
                    </div>
                </form>
            </div>

            <!-- Customer Reviews Admin -->
            <div class="admin-reviews" style="background: var(--white); padding: 2rem; border-radius: 10px; margin-top: 2rem;">
                <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;">üí¨ Customer Reviews (<span id="adminReviewCount">0</span>)</h2>
                <div id="adminReviewsList"></div>
            </div>

            <!-- Order History Section -->
            <div class="admin-orders" style="background: var(--white); padding: 2rem; border-radius: 10px; margin-top: 2rem;">
                <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;">üì¶ Order History (<span id="adminOrderCount">0</span>)</h2>
                <div id="adminOrdersList" style="overflow-x: auto;">
                    <!-- Orders will be displayed here -->
                </div>
            </div>

            <!-- Reports Section -->
            <div class="admin-reports" style="background: var(--white); padding: 2rem; border-radius: 10px; margin-top: 2rem; border-top: 3px solid var(--primary-color);">
                <h2 style="color: var(--primary-color); margin-bottom: 1.5rem;">üìä Reports & Analytics</h2>
                <p style="color: var(--text-light); margin-bottom: 2rem;">Download detailed reports for analysis. Reports are generated in CSV format and will be downloaded to your device.</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                    <!-- Bill-wise Report -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 1.5rem; border-radius: 10px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 0.5rem 0; font-size: 1.2rem;">üìÑ Bill-wise Report</h3>
                        <p style="margin: 0 0 1rem 0; opacity: 0.9; font-size: 0.9rem;">Individual order invoices with customer details</p>
                        <button onclick="downloadReport('bill-wise')" style="width: 100%; padding: 0.75rem; background: white; color: #667eea; border: none; border-radius: 5px; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">Download CSV</button>
                    </div>

                    <!-- Product-wise Report -->
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 1.5rem; border-radius: 10px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 0.5rem 0; font-size: 1.2rem;">üì¶ Product-wise Report</h3>
                        <p style="margin: 0 0 1rem 0; opacity: 0.9; font-size: 0.9rem;">Sales performance by product</p>
                        <button onclick="downloadReport('product-wise')" style="width: 100%; padding: 0.75rem; background: white; color: #f5576c; border: none; border-radius: 5px; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">Download CSV</button>
                    </div>

                    <!-- Month-wise Report -->
                    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 1.5rem; border-radius: 10px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 0.5rem 0; font-size: 1.2rem;">üìÖ Month-wise Report</h3>
                        <p style="margin: 0 0 1rem 0; opacity: 0.9; font-size: 0.9rem;">Monthly sales and revenue analysis</p>
                        <button onclick="downloadReport('month-wise')" style="width: 100%; padding: 0.75rem; background: white; color: #4facfe; border: none; border-radius: 5px; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">Download CSV</button>
                    </div>

                    <!-- Year-wise Report -->
                    <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); padding: 1.5rem; border-radius: 10px; color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h3 style="margin: 0 0 0.5rem 0; font-size: 1.2rem;">üìà Year-wise Report</h3>
                        <p style="margin: 0 0 1rem 0; opacity: 0.9; font-size: 0.9rem;">Annual sales summary and trends</p>
                        <button onclick="downloadReport('year-wise')" style="width: 100%; padding: 0.75rem; background: white; color: #43e97b; border: none; border-radius: 5px; font-weight: 600; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">Download CSV</button>
                    </div>
                </div>

                <div id="reportStatus" style="margin-top: 1.5rem; padding: 1rem; border-radius: 5px; display: none; text-align: center; font-weight: 600;"></div>
            </div>
        </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div id="orderDetailsModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 style="font-size: 1.5rem; color: var(--primary-color);">üìã Order Details</h2>
                <span class="close-btn" onclick="closeOrderDetails()">&times;</span>
            </div>
            <div id="orderDetailsContent" style="padding: 1rem 0;">
                <!-- Order details will be displayed here -->
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üõí Shopping Cart</h2>
                <span class="close-btn" onclick="closeCart()">&times;</span>
            </div>

            <!-- CART ITEMS VIEW (Step 1) -->
            <div id="cartItemsView" style="display: block;">
                <div id="cartItems">
                    <!-- Cart items will be dynamically loaded here -->
                </div>
                <div class="cart-summary" id="cartSummary" style="display: none;">
                    <div class="cart-total">
                        <span>Total:</span>
                        <span id="cartTotal">‚Çπ0.00</span>
                    </div>
                    <button class="checkout-btn" onclick="showCheckoutForm()">Proceed to Checkout</button>
                </div>
            </div>

            <!-- CHECKOUT DETAILS VIEW (Step 2) -->
            <div id="checkoutFormView" style="display: none;">
                <form id="checkoutForm" onsubmit="processCheckout(event)" style="padding: 2rem;">
                    <h3 style="color: var(--primary-color); margin-bottom: 1.5rem; text-align: center;">üìã Delivery Details</h3>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="customerName" style="font-weight: 600;">Full Name*</label>
                            <input type="text" id="customerName" required placeholder="John Doe" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; margin-top: 0.5rem;">
                        </div>

                        <div class="form-group">
                            <label for="customerPhone" style="font-weight: 600;">Phone Number*</label>
                            <input type="tel" id="customerPhone" required placeholder="9876543210" maxlength="10" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; margin-top: 0.5rem;">
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 1rem;">
                        <label for="customerEmail" style="font-weight: 600;">Gmail/Email*</label>
                        <input type="email" id="customerEmail" required placeholder="email@gmail.com" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; margin-top: 0.5rem;">
                    </div>

                    <div class="form-group" style="margin-top: 1rem;">
                        <label for="customerAddress" style="font-weight: 600;">Delivery Address*</label>
                        <textarea id="customerAddress" required placeholder="House no., Street, City, State, Pincode" rows="3" style="width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 8px; font-family: inherit; margin-top: 0.5rem;"></textarea>
                    </div>

                    <div style="background: var(--bg-light); padding: 1rem; border-radius: 8px; margin: 1.5rem 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>Subtotal:</span>
                            <span id="checkoutSubtotal">‚Çπ0.00</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-weight: 600; font-size: 1.2rem; color: var(--primary-color);">
                            <span>Total Amount:</span>
                            <span id="checkoutTotal">‚Çπ0.00</span>
                        </div>
                    </div>

                    <div style="display: flex; gap: 1rem;">
                        <button type="button" onclick="hideCheckoutForm()" class="nav-btn" style="flex: 1; background: #999; margin: 0;">‚Üê Back to Cart</button>
                        <button type="submit" class="checkout-btn" style="flex: 1;">‚úì Confirm Order</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    
    <!-- Order Confirmation Modal -->
    <div id="confirmationModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px; text-align: center;">
            <div class="modal-header" style="justify-content: center; border-bottom: 2px solid var(--primary-color);">
                <h2 style="margin: 0; font-size: 1.5rem; color: var(--primary-color);">‚úÖ Order Confirmed!</h2>
            </div>
            <div style="padding: 1.5rem 0;">
                <p id="orderMessage" style="font-size: 1rem; margin-bottom: 1.5rem; color: var(--text-dark);"></p>
                <div style="background: var(--bg-light); padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                    <p style="margin: 0.75rem 0; font-size: 1rem;"><strong>Order ID:</strong> <span id="orderId"></span></p>
                    <p style="margin: 0.75rem 0; font-size: 1rem;"><strong>Amount:</strong> <span id="confirmAmount"></span></p>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="generateAndDownloadPDF()" style="flex: 1; padding: 0.75rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1rem;">üì• Download PDF</button>
                    <button onclick="continueShop()" style="flex: 1; padding: 0.75rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 1rem;">üè™ Continue Shopping</button>
                </div>
            </div>
        </div>
    </div>

<!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>About Us</h3>
                <p>Maadhuri Shop is your trusted source for authentic Indian spices, grains, and organic products.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#products">Products</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Follow Us</h3>
                <p>Stay connected on social media</p>
                <div class="social-icons">
                    <a href="https://www.facebook.com/maadhuri.shop" target="_blank" rel="noopener noreferrer">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                        </svg>
                    </a>
                    <a href="https://www.instagram.com/maadhuri.shop" target="_blank" rel="noopener noreferrer">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Maadhuri Shop. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // API Configuration (moved to top for early access)
        // IMPORTANT: Replace 'YOUR_BACKEND_URL' with your actual backend API URL (e.g., from Render, Railway, Heroku, etc.)
        // Example: 'https://maadhuri-shop-backend.onrender.com/api' or 'https://api.yourdomain.com/api'
        const API_BASE_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
            ? 'http://localhost:5000/api'
            : (window.API_BASE_URL || 'YOUR_BACKEND_URL/api'); // REPLACE 'YOUR_BACKEND_URL' with your deployed backend URL
        
        // If you set window.API_BASE_URL before this script loads, it will use that instead
        // Example: <script>window.API_BASE_URL = 'https://your-backend.onrender.com';</script>

        // Products array - will be populated from API
        let products = [];

        let cart = [];
        let editingProductId = null;
        let totalOrders = 0;
        let totalRevenue = 0;
        let orderHistory = [];
        let productPollInterval = null; // For real-time updates

        // Load order history from localStorage
        function loadOrderHistory() {
            const stored = localStorage.getItem('maadhuriOrderHistory');
            if (stored) {
                orderHistory = JSON.parse(stored);
                // Update stats from order history
                totalOrders = orderHistory.length;
                totalRevenue = orderHistory.reduce((sum, order) => sum + order.total, 0);
            }
        }

        // Save order history to localStorage
        function saveOrderHistory() {
            localStorage.setItem('maadhuriOrderHistory', JSON.stringify(orderHistory));
        }

        // Initialize the application
        async function init() {
            loadOrderHistory();
            await fetchProductsFromAPI(); // Fetch products from API
            updateCartCount();
            updateAdminStats();
            startProductPolling(); // Start real-time updates
        }

        // Helper function to capitalize first letter (for category mapping)
        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // Helper function to map API product to frontend format
        function mapApiProductToFrontend(apiProduct) {
            // Map category: API uses capitalized (Spices), frontend uses lowercase (spices)
            const categoryMap = {
                'Spices': 'spices',
                'Grains': 'grains',
                'Oils': 'oils',
                'Dry Fruits': 'dryfruits',
                'Organic': 'organic',
                'Others': 'others'
            };
            const reverseCategoryMap = Object.fromEntries(
                Object.entries(categoryMap).map(([k, v]) => [v, k])
            );
            
            return {
                id: apiProduct._id || apiProduct.id, // Use _id from API as id
                _id: apiProduct._id, // Keep original _id for API calls
                name: apiProduct.name,
                category: categoryMap[apiProduct.category] || apiProduct.category.toLowerCase(),
                price: apiProduct.price,
                discount: apiProduct.discount || 0, // Default to 0 if not present
                description: apiProduct.description || '',
                image: apiProduct.image || '',
                stock: apiProduct.quantity || 0, // API uses 'quantity', frontend uses 'stock'
                quantity: apiProduct.quantity || 0, // Keep both for compatibility
                unit: apiProduct.unit || 'kg',
                inStock: apiProduct.inStock !== undefined ? apiProduct.inStock : (apiProduct.quantity > 0),
                sku: apiProduct.sku || '', // May not exist in API
                rating: apiProduct.rating || 0,
                reviews: apiProduct.reviews || 0
            };
        }

        // Helper function to map frontend product to API format
        function mapFrontendProductToApi(frontendProduct) {
            // Map category back: frontend uses lowercase, API uses capitalized
            const categoryMap = {
                'spices': 'Spices',
                'grains': 'Grains',
                'oils': 'Oils',
                'dryfruits': 'Dry Fruits',
                'organic': 'Organic',
                'others': 'Others',
                'pulses': 'Others' // Map pulses to Others if not in API enum
            };
            
            const apiProduct = {
                name: frontendProduct.name,
                category: categoryMap[frontendProduct.category] || capitalizeFirst(frontendProduct.category) || 'Others',
                price: parseFloat(frontendProduct.price),
                description: frontendProduct.description || '',
                image: frontendProduct.image || '',
                quantity: parseInt(frontendProduct.stock || frontendProduct.quantity || 0),
                unit: frontendProduct.unit || 'kg',
                inStock: frontendProduct.stock > 0 || frontendProduct.quantity > 0
            };

            // Only include rating and reviews if they exist
            if (frontendProduct.rating !== undefined) apiProduct.rating = parseFloat(frontendProduct.rating);
            if (frontendProduct.reviews !== undefined) apiProduct.reviews = parseInt(frontendProduct.reviews);

            return apiProduct;
        }

        // Fetch products from API
        async function fetchProductsFromAPI() {
            try {
                const response = await fetch(`${API_BASE_URL}/products`);
                if (!response.ok) {
                    throw new Error(`Failed to fetch products: ${response.statusText}`);
                }
                const apiProducts = await response.json();
                // Map API products to frontend format
                products = apiProducts.map(mapApiProductToFrontend);
                // Update the UI
                loadProducts();
            } catch (error) {
                console.error('Error fetching products:', error);
                showNotification('Failed to load products. Please refresh the page.', 'error');
                // Keep empty array if fetch fails
                products = [];
            }
        }

        // Start polling for product updates (real-time updates)
        function startProductPolling() {
            // Clear any existing interval
            if (productPollInterval) {
                clearInterval(productPollInterval);
            }
            // Poll every 5 seconds for updates
            productPollInterval = setInterval(async () => {
                try {
                    const response = await fetch(`${API_BASE_URL}/products`);
                    if (response.ok) {
                        const apiProducts = await response.json();
                        const newProducts = apiProducts.map(mapApiProductToFrontend);
                        // Compare products by creating a simple hash (length + first few IDs)
                        const currentHash = products.length + (products.length > 0 ? products[0]._id : '');
                        const newHash = newProducts.length + (newProducts.length > 0 ? newProducts[0]._id : '');
                        
                        // Only update if products changed
                        if (currentHash !== newHash) {
                            products = newProducts;
                            loadProducts();
                            updateAdminStats();
                        }
                    }
                } catch (error) {
                    console.error('Error polling products:', error);
                    // Don't show error notification for polling failures to avoid spam
                }
            }, 5000); // Poll every 5 seconds
        }

        // Stop polling (useful for cleanup)
        function stopProductPolling() {
            if (productPollInterval) {
                clearInterval(productPollInterval);
                productPollInterval = null;
            }
        }

        // Load products to grid
        function loadProducts() {
            const productGrid = document.getElementById('productGrid');
            productGrid.innerHTML = '';

            products.forEach(product => {
                const productId = product._id || product.id;
                const discount = product.discount || 0;
                const finalPrice = discount > 0 ? product.price * (1 - discount / 100) : product.price;
                
                // Image display with fallback
                const imageHTML = product.image && product.image.trim() !== '' ? 
                    `<img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.onerror=null; this.parentElement.querySelector('.no-image-placeholder').style.display='flex'; this.style.display='none';">` : 
                    '';
                
                const productCard = `
                    <div class="product-card" data-category="${product.category}">
                        <div class="product-image" style="position: relative; overflow: hidden; height: 250px;">
                            ${imageHTML}
                            <div class="no-image-placeholder" style="display: ${product.image && product.image.trim() !== '' ? 'none' : 'flex'}; align-items: center; justify-content: center; height: 100%; font-size: 3rem; background: linear-gradient(135deg, #f5f5f5, #e0e0e0); position: ${product.image && product.image.trim() !== '' ? 'absolute' : 'relative'}; top: 0; left: 0; right: 0; bottom: 0;">üñºÔ∏è</div>
                            ${discount > 0 ? `<span style="position: absolute; top: 10px; right: 10px; background: var(--accent-color); color: white; padding: 0.25rem 0.5rem; border-radius: 5px; font-size: 0.8rem; font-weight: bold; z-index: 10;">-${discount}%</span>` : ''}
                        </div>
                        <div class="product-info">
                            <div class="product-category">${product.category.toUpperCase()}</div>
                            <div class="product-name">${product.name}</div>
                            <div class="product-description">${product.description || ''}</div>
                            <div class="product-footer">
                                <div class="product-price">
                                    ${discount > 0 ? `<span style="text-decoration: line-through; color: var(--text-light); font-size: 1rem; margin-right: 0.5rem;">‚Çπ${product.price.toFixed(2)}</span>` : ''}
                                    <span style="color: var(--primary-color);">‚Çπ${finalPrice.toFixed(2)}</span>
                                </div>
                                <button class="add-to-cart-btn" onclick="addToCart('${productId}')">Add to Cart</button>
                            </div>
                        </div>
                    </div>
                `;
                productGrid.innerHTML += productCard;
            });

            loadProductsTable();
        }

        // Filter products
        function filterProducts() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const productCards = document.querySelectorAll('.product-card');

            productCards.forEach(card => {
                const productName = card.querySelector('.product-name').textContent.toLowerCase();
                const productCategory = card.getAttribute('data-category');

                const matchesSearch = productName.includes(searchTerm);
                const matchesCategory = category === 'all' || productCategory === category;

                if (matchesSearch && matchesCategory) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Sort products
        function sortProducts() {
            const sortValue = document.getElementById('sortFilter').value;
            
            if (sortValue === 'default') {
                loadProducts();
                return;
            }

            let sortedProducts = [...products];

            switch (sortValue) {
                case 'name-asc':
                    sortedProducts.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'name-desc':
                    sortedProducts.sort((a, b) => b.name.localeCompare(a.name));
                    break;
                case 'price-asc':
                    sortedProducts.sort((a, b) => a.price - b.price);
                    break;
                case 'price-desc':
                    sortedProducts.sort((a, b) => b.price - a.price);
                    break;
            }

            products = sortedProducts;
            loadProducts();
        }

        // Calculate final price with discount
        function getFinalPrice(product) {
            const discount = product.discount || 0;
            return discount > 0 ? product.price * (1 - discount / 100) : product.price;
        }

        // Add to cart
        function addToCart(productId) {
            const product = products.find(p => p._id === productId || p.id === productId);
            
            if (!product) {
                showNotification('Product not found!', 'error');
                return;
            }
            
            // Check stock availability
            const stock = product.stock || product.quantity || 0;
            if (stock <= 0) {
                showNotification('Sorry, this product is out of stock!', 'error');
                return;
            }
            
            const productIdForCart = product._id || product.id;
            const existingItem = cart.find(item => (item._id === productIdForCart) || (item.id === productIdForCart));

            if (existingItem) {
                if (existingItem.quantity >= stock) {
                    showNotification('Cannot add more - stock limit reached!', 'error');
                    return;
                }
                existingItem.quantity++;
            } else {
                const finalPrice = getFinalPrice(product);
                cart.push({ ...product, id: productIdForCart, quantity: 1, finalPrice: finalPrice });
            }

            updateCartCount();
            showNotification('Product added to cart!', 'success');
        }

        // Calculate cart total
        function calculateCartTotal() {
            return cart.reduce((sum, item) => {
                const finalPrice = item.finalPrice || getFinalPrice(item);
                return sum + (finalPrice * item.quantity);
            }, 0);
        }

        // Update cart count
        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = totalItems;
        }

        // Open cart modal
        function openCart() {
            const modal = document.getElementById('cartModal');
            modal.style.display = 'block';
            renderCart();
        }

        // Close cart modal
        function closeCart() {
            const modal = document.getElementById('cartModal');
            modal.style.display = 'none';
        }

        // Render cart items
        function renderCart() {
            const cartItemsContainer = document.getElementById('cartItems');
            const cartSummary = document.getElementById('cartSummary');

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<div class="empty-cart"><h3>Your cart is empty</h3><p>Add some products to get started!</p></div>';
                cartSummary.style.display = 'none';
                return;
            }

            let cartHTML = '';
            let total = 0;

            cart.forEach(item => {
                const finalPrice = item.finalPrice || getFinalPrice(item);
                const itemTotal = finalPrice * item.quantity;
                total += itemTotal;

                cartHTML += `
                    <div class="cart-item">
                        <div class="cart-item-image">
                            ${item.image ? `<img src="${item.image}" alt="${item.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 5px;">` : (item.emoji || 'üõçÔ∏è')}
                        </div>
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">
                                ${item.discount > 0 ? `<span style="text-decoration: line-through; color: var(--text-light); font-size: 0.9rem;">‚Çπ${item.price.toFixed(2)}</span> ` : ''}
                                ‚Çπ${finalPrice.toFixed(2)} √ó ${item.quantity} = ‚Çπ${itemTotal.toFixed(2)}
                            </div>
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="decreaseQuantity(${item.id})">-</button>
                                <span>${item.quantity}</span>
                                <button class="quantity-btn" onclick="increaseQuantity(${item.id})">+</button>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="removeFromCart(${item.id})">Remove</button>
                    </div>
                `;
            });

            cartItemsContainer.innerHTML = cartHTML;
            document.getElementById('cartTotal').textContent = `‚Çπ${total.toFixed(2)}`;
            cartSummary.style.display = 'block';
        }

        // Increase quantity
        function increaseQuantity(productId) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity++;
                updateCartCount();
                renderCart();
            }
        }

        // Decrease quantity
        function decreaseQuantity(productId) {
            const item = cart.find(item => item.id === productId);
            if (item && item.quantity > 1) {
                item.quantity--;
                updateCartCount();
                renderCart();
            }
        }

        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartCount();
            renderCart();
            showNotification('Product removed from cart', 'success');
        }

        // Checkout
        function checkout() {
            if (cart.length === 0) {
                showNotification('Your cart is empty!', 'error');
                return;
            }

            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            totalOrders++;
            totalRevenue += total;
            
            showNotification('Order placed successfully! Thank you for shopping with us.', 'success');
            cart = [];
            updateCartCount();
            renderCart();
            updateAdminStats();
            
            setTimeout(() => {
                closeCart();
            }, 2000);
        }

        // Show Admin Panel
        function showAdminPanel() {
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
            document.querySelector('footer').style.display = 'none';
            updateAdminStats();
        }

        // Hide Admin Panel
        function hideAdminPanel() {
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('adminPanel').style.display = 'none';
            document.querySelector('footer').style.display = 'block';
            resetForm();
        }

        // Update Admin Stats
        function updateAdminStats() {
            // Calculate from order history
            const actualOrders = orderHistory.length;
            const actualRevenue = orderHistory.reduce((sum, order) => sum + order.total, 0);
            const pendingOrders = orderHistory.filter(order => order.status === 'Pending' || !order.status).length;
            
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalRevenue').textContent = `‚Çπ${actualRevenue.toFixed(2)}`;
            document.getElementById('totalOrders').textContent = actualOrders;
            
            const avgValue = actualOrders > 0 ? actualRevenue / actualOrders : 0;
            document.getElementById('avgOrderValue').textContent = `‚Çπ${avgValue.toFixed(2)}`;
            
            document.getElementById('pendingOrders').textContent = pendingOrders;
            
            // Count low stock items (stock < 10)
            const lowStock = products.filter(p => (p.stock || p.quantity || 0) < 10).length;
            document.getElementById('lowStockItems').textContent = lowStock;
        }

        // Load products table
        function loadProductsTable() {
            const tableBody = document.getElementById('productsTableBody');
            tableBody.innerHTML = '';

            products.forEach(product => {
                const productId = product._id || product.id;
                const stock = product.stock || product.quantity || 0;
                const stockClass = stock < 10 ? 'style="color: red; font-weight: bold;"' : '';
                const discount = product.discount || 0;
                const finalPrice = discount > 0 ? product.price * (1 - discount / 100) : product.price;
                const priceDisplay = discount > 0 ? 
                    `<span style="text-decoration: line-through; color: var(--text-light);">‚Çπ${product.price.toFixed(2)}</span><br><span style="color: var(--primary-color); font-weight: bold;">‚Çπ${finalPrice.toFixed(2)}</span> <span style="color: var(--accent-color);">(-${discount}%)</span>` :
                    `‚Çπ${product.price.toFixed(2)}`;
                
                // Use JSON.stringify for the ID to handle both string and number IDs safely
                const row = `
                    <tr>
                        <td>${String(productId).substring(0, 8)}...</td>
                        <td>${product.name}</td>
                        <td>${product.category}</td>
                        <td>${priceDisplay}</td>
                        <td ${stockClass}>${stock}</td>
                        <td>${product.sku || '-'}</td>
                        <td>
                            <div class="action-btns">
                                <button class="btn-edit" onclick="editProduct('${productId}')">Edit</button>
                                <button class="btn-delete" onclick="deleteProduct('${productId}')">Delete</button>
                            </div>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        }

        // Calculate discounted price
        function calculateDiscountedPrice() {
            const price = parseFloat(document.getElementById('productPrice').value) || 0;
            const discount = parseFloat(document.getElementById('productDiscount').value) || 0;
            const displayDiv = document.getElementById('discountedPriceDisplay');
            const valueSpan = document.getElementById('discountedPriceValue');
            
            if (price > 0 && discount > 0) {
                const discountedPrice = price * (1 - discount / 100);
                valueSpan.textContent = discountedPrice.toFixed(2);
                displayDiv.style.display = 'block';
            } else {
                displayDiv.style.display = 'none';
            }
        }

        // Save product
        function saveProduct(event) {
            event.preventDefault();

            const id = document.getElementById('productId').value;
            const name = document.getElementById('productName').value;
            const category = document.getElementById('productCategory').value;
            const price = parseFloat(document.getElementById('productPrice').value);
            const discount = parseFloat(document.getElementById('productDiscount').value) || 0;
            const description = document.getElementById('productDescription').value;
            const image = document.getElementById('productImage').value;
            const stock = parseInt(document.getElementById('productStock').value);
            const sku = document.getElementById('productSKU').value;

            if (id) {
                // Update existing product
                const productIndex = products.findIndex(p => p.id === parseInt(id));
                if (productIndex !== -1) {
                    products[productIndex] = { id: parseInt(id), name, category, price, discount, description, image, stock, sku };
                    showNotification('Product updated successfully!', 'success');
                }
            } else {
                // Add new product
                const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                products.push({ id: newId, name, category, price, discount, description, image, stock, sku });
                showNotification('Product added successfully!', 'success');
            }

            loadProducts();
            updateAdminStats();
            resetForm();
        }

        // Edit product
        function editProduct(productId) {
            const product = products.find(p => p._id === productId || p.id === productId);
            if (product) {
                document.getElementById('productId').value = product._id || product.id;
                document.getElementById('productName').value = product.name;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productDiscount').value = product.discount || 0;
                document.getElementById('productDescription').value = product.description || '';
                document.getElementById('productImage').value = product.image || '';
                document.getElementById('productStock').value = product.stock || product.quantity || 0;
                document.getElementById('productSKU').value = product.sku || '';
                document.getElementById('formTitle').textContent = 'Edit Product';
                
                calculateDiscountedPrice();
                
                // Scroll to form
                document.getElementById('productForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Delete product (using API)
        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) {
                return;
            }

            try {
                // Find the product to get its _id
                const product = products.find(p => p._id === productId || p.id === productId);
                if (!product) {
                    throw new Error('Product not found');
                }

                const response = await fetch(`${API_BASE_URL}/products/${product._id || productId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to delete product');
                }

                // Refresh products from API
                await fetchProductsFromAPI();
                updateAdminStats();
                showNotification('Product deleted successfully!', 'success');
            } catch (error) {
                console.error('Error deleting product:', error);
                showNotification(`Failed to delete product: ${error.message}`, 'error');
            }
        }

        // Reset form
        function resetForm() {
            document.getElementById('productForm').reset();
            document.getElementById('productId').value = '';
            document.getElementById('formTitle').textContent = 'Add New Product';
            document.getElementById('discountedPriceDisplay').style.display = 'none';
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // Toggle mobile menu
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const cartModal = document.getElementById('cartModal');
            const orderModal = document.getElementById('orderDetailsModal');
            const loginModal = document.getElementById('loginModal');
            if (event.target === cartModal) {
                closeCart();
            }
            if (event.target === orderModal) {
                closeOrderDetails();
            }
            if (event.target === loginModal) {
                closeLoginModal();
            }
        }

        // Initialize on page load
        window.onload = init;
    

        // Weekly Recipe Management
        let weeklyRecipe = {
            title: 'Butter Chicken',
            prepTime: '45 mins',
            serves: '4 servings',
            difficulty: 'Medium',
            image: 'https://images.unsplash.com/photo-1585937421612-70a008356fbe?w=800&h=600&fit=crop',
            description: 'A rich and creamy North Indian curry with tender chicken pieces in a tomato-based sauce with butter and cream. Perfect with naan or rice!',
            ingredients: 'Chicken, Butter, Cream, Tomatoes, Garam Masala, Ginger-Garlic Paste'
        };

        // Customer Reviews - Start with EMPTY array
        let customerReviews = [];

        let selectedRating = 0;
        let reviewsExpanded = false;

        // Star rating functionality
        function initStarRating() {
            const stars = document.querySelectorAll('.star');
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    selectedRating = parseInt(this.getAttribute('data-rating'));
                    document.getElementById('reviewRating').value = selectedRating;
                    updateStars(selectedRating);
                });

                star.addEventListener('mouseenter', function() {
                    const rating = parseInt(this.getAttribute('data-rating'));
                    updateStars(rating);
                });
            });

            document.querySelector('.star-rating').addEventListener('mouseleave', function() {
                updateStars(selectedRating);
            });
        }

        function updateStars(rating) {
            const stars = document.querySelectorAll('.star');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
        }

        // Submit review
        function submitReview(event) {
            event.preventDefault();

            const name = document.getElementById('reviewName').value;
            const email = document.getElementById('reviewEmail').value;
            const rating = parseInt(document.getElementById('reviewRating').value);
            const text = document.getElementById('reviewText').value;

            if (!rating) {
                alert('Please select a rating!');
                return;
            }

            const newReview = {
                id: customerReviews.length + 1,
                name: name,
                email: email,
                rating: rating,
                text: text,
                date: new Date()
            };

            customerReviews.unshift(newReview);
            updateReviewCount();

            // If reviews are expanded, update the display
            if (reviewsExpanded) {
                displayReviews();
            }

            // Reset form
            document.getElementById('reviewForm').reset();
            selectedRating = 0;
            updateStars(0);

            alert('‚úÖ Thank you for your review! It has been submitted successfully.');
        }

        // Update review count
        function updateReviewCount() {
            const countElement = document.getElementById('reviewCount');
            if (countElement) {
                countElement.textContent = customerReviews.length;
            }
        }

        // Toggle reviews display
        function toggleReviews() {
            reviewsExpanded = !reviewsExpanded;
            const container = document.getElementById('reviewsContainer');
            const btn = document.getElementById('toggleReviewsBtn');

            if (reviewsExpanded) {
                container.style.display = 'grid';
                btn.textContent = 'Hide Reviews';
                displayReviews();
            } else {
                container.style.display = 'none';
                btn.textContent = 'See All Reviews';
            }
        }

        // Display reviews
        function displayReviews() {
            const container = document.getElementById('reviewsContainer');

            if (customerReviews.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">No reviews yet. Be the first to write a review!</p>';
                return;
            }

            container.innerHTML = customerReviews.map(review => {
                const initial = review.name.charAt(0).toUpperCase();
                const dateStr = review.date.toLocaleDateString('en-IN', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                const stars = '‚òÖ'.repeat(review.rating) + '‚òÜ'.repeat(5 - review.rating);

                return `
                    <div class="review-item">
                        <div class="review-header">
                            <div class="review-avatar">${initial}</div>
                            <div class="review-info">
                                <h4>${review.name}</h4>
                                <div class="review-stars">${stars}</div>
                            </div>
                            <div class="review-date">${dateStr}</div>
                        </div>
                        <p class="review-text">${review.text}</p>
                    </div>
                `;
            }).join('');
        }

        // Load current recipe into admin form
        function loadCurrentRecipe() {
            if (document.getElementById('recipeNameInput')) {
                document.getElementById('recipeNameInput').value = weeklyRecipe.title;
                document.getElementById('recipePrepTimeInput').value = weeklyRecipe.prepTime;
                document.getElementById('recipeServesInput').value = weeklyRecipe.serves;
                document.getElementById('recipeDifficultyInput').value = weeklyRecipe.difficulty;
                document.getElementById('recipeImageInput').value = weeklyRecipe.image;
                document.getElementById('recipeDescInput').value = weeklyRecipe.description;
                document.getElementById('recipeIngredientsInput').value = weeklyRecipe.ingredients;
            }
        }

        // Save recipe from admin
        function saveRecipe(event) {
            event.preventDefault();

            weeklyRecipe = {
                title: document.getElementById('recipeNameInput').value,
                prepTime: document.getElementById('recipePrepTimeInput').value,
                serves: document.getElementById('recipeServesInput').value,
                difficulty: document.getElementById('recipeDifficultyInput').value,
                image: document.getElementById('recipeImageInput').value,
                description: document.getElementById('recipeDescInput').value,
                ingredients: document.getElementById('recipeIngredientsInput').value
            };

            updatePublicRecipe();
            alert('‚úÖ Recipe updated successfully!');
        }

        // Update public recipe display
        function updatePublicRecipe() {
            document.getElementById('recipeTitle').textContent = weeklyRecipe.title;
            document.getElementById('recipePrepTime').textContent = weeklyRecipe.prepTime;
            document.getElementById('recipeServes').textContent = weeklyRecipe.serves;
            document.getElementById('recipeDifficulty').textContent = weeklyRecipe.difficulty;
            document.getElementById('recipeImage').src = weeklyRecipe.image;
            document.getElementById('recipeImage').alt = weeklyRecipe.title;
            document.getElementById('recipeDescription').textContent = weeklyRecipe.description;
            document.getElementById('recipeIngredients').textContent = weeklyRecipe.ingredients;
        }

        // Display reviews in admin panel
        function displayAdminReviews() {

            // Update admin review count
            const countEl = document.getElementById('adminReviewCount');
            if (countEl) countEl.textContent = customerReviews.length;
            
            const container = document.getElementById('adminReviewsList');
            if (!container) return;

            if (customerReviews.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">No reviews yet.</p>';
                return;
            }

            container.innerHTML = `
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-light); text-align: left;">
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Customer</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Email</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Rating</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Review</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${customerReviews.map(review => {
                            const stars = '‚òÖ'.repeat(review.rating) + '‚òÜ'.repeat(5 - review.rating);
                            const dateStr = review.date.toLocaleDateString('en-IN', { 
                                year: 'numeric', 
                                month: 'short', 
                                day: 'numeric' 
                            });
                            return `
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 1rem;">${review.name}</td>
                                    <td style="padding: 1rem; color: var(--text-light);">${review.email}</td>
                                    <td style="padding: 1rem; color: #ffc107;">${stars}</td>
                                    <td style="padding: 1rem; max-width: 300px;">${review.text}</td>
                                    <td style="padding: 1rem; color: var(--text-light); white-space: nowrap;">${dateStr}</td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                </table>
            `;
        }

        // Display order history in admin panel
        function displayOrderHistory() {
            const container = document.getElementById('adminOrdersList');
            const countEl = document.getElementById('adminOrderCount');
            
            if (countEl) countEl.textContent = orderHistory.length;
            if (!container) return;

            if (orderHistory.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">No orders yet.</p>';
                return;
            }

            container.innerHTML = `
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-light); text-align: left;">
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Order ID</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Customer</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Email</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Date</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Amount</th>
                            <th style="padding: 1rem; border-bottom: 2px solid #e0e0e0;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${orderHistory.map(order => {
                            const dateStr = new Date(order.timestamp).toLocaleDateString('en-IN', { 
                                year: 'numeric', 
                                month: 'short', 
                                day: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            return `
                                <tr style="border-bottom: 1px solid #e0e0e0;">
                                    <td style="padding: 1rem;">${order.orderId}</td>
                                    <td style="padding: 1rem;">${order.customerName}</td>
                                    <td style="padding: 1rem; color: var(--text-light);">${order.customerEmail}</td>
                                    <td style="padding: 1rem; color: var(--text-light); white-space: nowrap;">${dateStr}</td>
                                    <td style="padding: 1rem; font-weight: bold; color: var(--primary-color);">‚Çπ${order.total.toFixed(2)}</td>
                                    <td style="padding: 1rem;">
                                        <button class="btn-edit" onclick="viewOrderDetails('${order.orderId}')">View Details</button>
                                    </td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                </table>
            `;
        }

        // View order details
        function viewOrderDetails(orderId) {
            const order = orderHistory.find(o => o.orderId === orderId);
            if (!order) {
                alert('Order not found');
                return;
            }

            const itemsHTML = order.items.map(item => {
                const finalPrice = item.finalPrice || getFinalPrice(item);
                return `
                    <tr style="border-bottom: 1px solid #e0e0e0;">
                        <td style="padding: 0.75rem;">${item.name}</td>
                        <td style="padding: 0.75rem; text-align: center;">${item.quantity}</td>
                        <td style="padding: 0.75rem; text-align: right;">‚Çπ${finalPrice.toFixed(2)}</td>
                        <td style="padding: 0.75rem; text-align: right; font-weight: bold;">‚Çπ${(finalPrice * item.quantity).toFixed(2)}</td>
                    </tr>
                `;
            }).join('');

            const content = `
                <div style="padding: 1rem;">
                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">Order Information</h3>
                    <div style="background: var(--bg-light); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <p style="margin: 0.5rem 0;"><strong>Order ID:</strong> ${order.orderId}</p>
                        <p style="margin: 0.5rem 0;"><strong>Date:</strong> ${order.date}</p>
                    </div>

                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">Customer Details</h3>
                    <div style="background: var(--bg-light); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
                        <p style="margin: 0.5rem 0;"><strong>Name:</strong> ${order.customerName}</p>
                        <p style="margin: 0.5rem 0;"><strong>Email:</strong> ${order.customerEmail}</p>
                        <p style="margin: 0.5rem 0;"><strong>Phone:</strong> ${order.customerPhone}</p>
                        <p style="margin: 0.5rem 0;"><strong>Address:</strong> ${order.customerAddress}</p>
                    </div>

                    <h3 style="color: var(--primary-color); margin-bottom: 1rem;">Order Items</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 1.5rem;">
                        <thead>
                            <tr style="background: var(--bg-light);">
                                <th style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #e0e0e0;">Product</th>
                                <th style="padding: 0.75rem; text-align: center; border-bottom: 2px solid #e0e0e0;">Quantity</th>
                                <th style="padding: 0.75rem; text-align: right; border-bottom: 2px solid #e0e0e0;">Price</th>
                                <th style="padding: 0.75rem; text-align: right; border-bottom: 2px solid #e0e0e0;">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${itemsHTML}
                        </tbody>
                    </table>

                    <div style="text-align: right; padding-top: 1rem; border-top: 2px solid var(--primary-color);">
                        <h3 style="color: var(--primary-color); margin: 0;">
                            Total Amount: ‚Çπ${order.total.toFixed(2)}
                        </h3>
                    </div>
                </div>
            `;

            document.getElementById('orderDetailsContent').innerHTML = content;
            document.getElementById('orderDetailsModal').style.display = 'block';
        }

        // Close order details modal
        function closeOrderDetails() {
            document.getElementById('orderDetailsModal').style.display = 'none';
        }

        // Download Report Function
        async function downloadReport(reportType) {
            const statusEl = document.getElementById('reportStatus');
            const reportTypes = {
                'bill-wise': 'Bill-wise Report',
                'product-wise': 'Product-wise Report',
                'month-wise': 'Month-wise Report',
                'year-wise': 'Year-wise Report'
            };

            const reportName = reportTypes[reportType] || 'Report';
            
            if (statusEl) {
                statusEl.style.display = 'block';
                statusEl.style.background = '#fff3cd';
                statusEl.style.color = '#856404';
                statusEl.textContent = `‚è≥ Generating ${reportName}...`;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/reports/${reportType}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ error: 'Failed to generate report' }));
                    throw new Error(errorData.error || 'Failed to generate report');
                }

                // Get the CSV content
                const csvContent = await response.text();
                
                // Create a blob and download link
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                
                // Set filename with timestamp
                const timestamp = new Date().toISOString().slice(0, 10).replace(/-/g, '');
                link.download = `${reportType}-report-${timestamp}.csv`;
                
                // Trigger download
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);

                if (statusEl) {
                    statusEl.style.background = '#d4edda';
                    statusEl.style.color = '#155724';
                    statusEl.textContent = `‚úÖ ${reportName} downloaded successfully!`;
                    
                    // Hide status message after 3 seconds
                    setTimeout(() => {
                        statusEl.style.display = 'none';
                    }, 3000);
                }
            } catch (error) {
                console.error('Report download error:', error);
                
                if (statusEl) {
                    statusEl.style.background = '#f8d7da';
                    statusEl.style.color = '#721c24';
                    statusEl.textContent = `‚ùå Error: ${error.message || 'Failed to download report'}`;
                    
                    // Hide status message after 5 seconds
                    setTimeout(() => {
                        statusEl.style.display = 'none';
                    }, 5000);
                } else {
                    alert(`Error downloading ${reportName}: ${error.message || 'Please try again later'}`);
                }
            }
        }

        // Enhanced showAdminPanel
        const originalShowAdminPanel = typeof showAdminPanel !== 'undefined' ? showAdminPanel : null;
        function showAdminPanel() {
            if (originalShowAdminPanel) {
                originalShowAdminPanel();
            } else {
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('mainContent').style.display = 'none';
            }
            loadCurrentRecipe();
            displayAdminReviews();
            displayOrderHistory();
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            initStarRating();
            updateReviewCount();
        });


    

        // Integrated Checkout System (in-cart checkout)
        let currentOrder = null;

        // Show checkout form inside cart (slide transition)
        function showCheckoutForm() {
            document.getElementById('cartItemsView').style.display = 'none';
            document.getElementById('checkoutFormView').style.display = 'block';

            // Update checkout totals
            const total = calculateCartTotal();
            document.getElementById('checkoutSubtotal').textContent = '‚Çπ' + total.toFixed(2);
            document.getElementById('checkoutTotal').textContent = '‚Çπ' + total.toFixed(2);
        }

        // Hide checkout form and go back to cart items
        function hideCheckoutForm() {
            document.getElementById('checkoutFormView').style.display = 'none';
            document.getElementById('cartItemsView').style.display = 'block';
        }

        // Process checkout with customer details
        async function processCheckout(event) {
            event.preventDefault();

            // Collect customer details
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const customerEmail = document.getElementById('customerEmail').value;
            const customerAddress = document.getElementById('customerAddress').value;

            // Validate all fields
            if (!customerName || !customerPhone || !customerEmail || !customerAddress) {
                alert('‚ùå Please fill all required fields');
                return;
            }

            // Validate email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(customerEmail)) {
                alert('‚ùå Please enter a valid email');
                return;
            }

            // Validate phone
            const phoneRegex = /^[0-9]{10,}$/;
            const phoneNumber = customerPhone.replace(/[^0-9]/g, '');
            if (phoneNumber.length < 10) {
                alert('‚ùå Please enter a valid phone number');
                return;
            }

            // Prepare order data for backend
            const totalAmount = calculateCartTotal();
            const orderItems = cart.map(item => ({
                productId: item.id || item.productId || null,
                productName: item.name,
                quantity: item.quantity,
                price: item.price,
                unit: item.unit || 'piece'
            }));

            const orderData = {
                customerName: customerName,
                customerEmail: customerEmail,
                customerPhone: phoneNumber,
                shippingAddress: customerAddress, // Backend will parse this
                items: orderItems,
                totalAmount: totalAmount
            };

            // Disable submit button
            const submitButton = event.target.querySelector('button[type="submit"]');
            const originalButtonText = submitButton ? submitButton.textContent : '';
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.textContent = 'Processing...';
            }

            try {
                // Call backend API to create order
                const response = await fetch(`${API_BASE_URL}/orders`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(orderData)
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    // Create order object for local use
                    currentOrder = {
                        orderId: data.orderId,
                        customerName: customerName,
                        customerPhone: phoneNumber,
                        customerEmail: customerEmail,
                        customerAddress: customerAddress,
                        items: JSON.parse(JSON.stringify(cart)), // Deep copy
                        total: totalAmount,
                        date: new Date().toLocaleString('en-IN'),
                        timestamp: new Date().getTime(),
                        status: 'Pending'
                    };

                    // Save to order history
                    orderHistory.push(currentOrder);
                    saveOrderHistory();
                    
                    // Update stats
                    totalOrders++;
                    totalRevenue += currentOrder.total;

                    // Close cart and show confirmation
                    closeCart();
                    showOrderConfirmation();

                    // Emails are sent automatically by backend
                    console.log('‚úÖ Order created. Confirmation emails sent to customer and admin.');
                } else {
                    throw new Error(data.error || 'Failed to create order');
                }
            } catch (error) {
                console.error('Order creation error:', error);
                alert('‚ùå Failed to create order: ' + (error.message || 'Please try again later'));
                
                // Fallback: create order locally if API fails
                currentOrder = {
                    orderId: 'ORD-' + Date.now(),
                    customerName: customerName,
                    customerPhone: phoneNumber,
                    customerEmail: customerEmail,
                    customerAddress: customerAddress,
                    items: JSON.parse(JSON.stringify(cart)),
                    total: totalAmount,
                    date: new Date().toLocaleString('en-IN'),
                    timestamp: new Date().getTime(),
                    status: 'Pending'
                };
                orderHistory.push(currentOrder);
                saveOrderHistory();
                totalOrders++;
                totalRevenue += currentOrder.total;
                closeCart();
                showOrderConfirmation();
                alert('‚ö†Ô∏è Order saved locally. Emails may not have been sent. Please contact support.');
            } finally {
                if (submitButton) {
                    submitButton.disabled = false;
                    submitButton.textContent = originalButtonText;
                }
            }
        }

        function showOrderConfirmation() {
            document.getElementById('orderId').textContent = currentOrder.orderId;
            document.getElementById('confirmAmount').textContent = '‚Çπ' + currentOrder.total.toFixed(2);
            document.getElementById('orderMessage').textContent = 'Order placed successfully! Check your email (' + currentOrder.customerEmail + ') for confirmation.';

            document.getElementById('confirmationModal').style.display = 'block';

            // Clear cart
            cart = [];
            updateCartCount();
            updateCartDisplay();
        }

        function sendOrderEmail() {
            // Emails are now sent automatically by the backend API
            console.log('Order confirmation emails sent to customer and admin via backend API');
        }

        function generatePDF() {
            if (!currentOrder) {
                alert('‚ùå No order found');
                return;
            }

            // Create PDF content
            const pdfContent = generatePDFContent();

            // Create and download
            const blob = new Blob([pdfContent], { type: 'text/html' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Order_' + currentOrder.orderId + '.html';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(url);

            // Open print dialog
            setTimeout(() => {
                const printWindow = window.open('', '', 'width=900,height=600');
                printWindow.document.write(pdfContent);
                printWindow.document.close();
                printWindow.print();
            }, 500);
        }

        function generatePDFContent() {
            const itemsHTML = currentOrder.items.map(item => {
                const finalPrice = item.finalPrice || getFinalPrice(item);
                const itemTotal = finalPrice * item.quantity;
                return `
                <tr>
                    <td>${item.name}</td>
                    <td style="text-align: center;">${item.quantity}</td>
                    <td style="text-align: right;">‚Çπ${finalPrice.toFixed(2)}</td>
                    <td style="text-align: right;">‚Çπ${itemTotal.toFixed(2)}</td>
                </tr>
            `;
            }).join('');

            return `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Order ${currentOrder.orderId}</title>
    <style>
        @media print {
            body { margin: 0; padding: 20px; }
        }
        body { 
            font-family: Arial, sans-serif; 
            margin: 0;
            padding: 20px;
            background: white;
            color: #333;
        }
        .header { 
            text-align: center; 
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2c5f2d;
        }
        .header h1 { 
            color: #2c5f2d; 
            margin: 0 0 10px 0;
            font-size: 28px;
        }
        .header p { 
            margin: 5px 0; 
            color: #666;
            font-size: 14px;
        }
        .order-details { 
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .order-details h3 {
            margin-top: 0;
            color: #2c5f2d;
            font-size: 18px;
        }
        .details-row { 
            margin: 8px 0;
            font-size: 14px;
        }
        .details-row strong { 
            display: inline-block; 
            width: 120px;
            color: #333;
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0;
            background: white;
        }
        table th { 
            background: #2c5f2d; 
            color: white; 
            padding: 12px; 
            text-align: left;
            font-size: 14px;
            font-weight: 600;
        }
        table td { 
            padding: 10px 12px; 
            border-bottom: 1px solid #ddd;
            font-size: 14px;
        }
        table tr:last-child td {
            border-bottom: none;
        }
        .total { 
            text-align: right; 
            font-size: 20px; 
            font-weight: bold; 
            margin-top: 20px; 
            padding-top: 15px;
            border-top: 2px solid #2c5f2d;
            color: #2c5f2d; 
        }
        .footer { 
            margin-top: 30px; 
            padding-top: 20px; 
            border-top: 1px solid #ddd; 
            font-size: 12px; 
            color: #666;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåø Maadhuri Shop</h1>
        <p>Invoice / Order Receipt</p>
    </div>

    <div class="order-details">
        <h3>Order Information</h3>
        <div class="details-row"><strong>Order ID:</strong> ${currentOrder.orderId}</div>
        <div class="details-row"><strong>Date:</strong> ${currentOrder.date}</div>
        <div class="details-row"><strong>Status:</strong> Confirmed</div>
    </div>

    <div class="order-details">
        <h3>Customer Details</h3>
        <div class="details-row"><strong>Name:</strong> ${currentOrder.customerName}</div>
        <div class="details-row"><strong>Email:</strong> ${currentOrder.customerEmail}</div>
        <div class="details-row"><strong>Phone:</strong> ${currentOrder.customerPhone}</div>
        <div class="details-row"><strong>Address:</strong> ${currentOrder.customerAddress}</div>
    </div>

    <div>
        <h3>Order Items</h3>
        <table>
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                ${itemsHTML}
            </tbody>
        </table>
    </div>

    <div class="total">
        <div>Total Amount: ‚Çπ${currentOrder.total.toFixed(2)}</div>
    </div>

    <div class="footer">
        <p>Thank you for shopping with Maadhuri Shop!</p>
        <p>For inquiries, contact us at contact@maadhuri.com</p>
        <p>This is an automated receipt. No signature required.</p>
    </div>
</body>
</html>
            `;
        }

        function continueShop() {
            document.getElementById('confirmationModal').style.display = 'none';
            currentOrder = null;
            // Render cart to show empty state
            renderCart();
        }

        // Admin Login System
        let adminCredentials = {
            email: 'admin@gmail.com',
            password: 'admin123'
        };

        let isLoggedIn = false;

        // Open Admin Login Modal
        function openAdminLogin() {
            document.getElementById('loginModal').style.display = 'flex';
            document.getElementById('loginForm').reset();
            document.getElementById('loginError').style.display = 'none';
        }

        // Close Login Modal
        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('loginForm').reset();
            document.getElementById('loginError').style.display = 'none';
        }

        async function handleLogin(event) {
            event.preventDefault();

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');

            // Show loading state
            errorEl.style.display = 'none';
            const submitButton = event.target.querySelector('button[type="submit"]');
            const originalButtonText = submitButton ? submitButton.textContent : '';
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.textContent = 'Logging in...';
            }

            try {
                // Call backend API
                const response = await fetch(`${API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();

                if (response.ok && data.success) {
                    isLoggedIn = true;
                    errorEl.style.display = 'none';

                    document.getElementById('loginModal').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    document.getElementById('mainContent').style.display = 'none';
                    document.querySelector('footer').style.display = 'none';

                    sessionStorage.setItem('adminLoggedIn', 'true');
                    
                    // Load admin data
                    loadCurrentRecipe();
                    displayAdminReviews();
                    displayOrderHistory();
                    updateAdminStats();
                    
                    alert('‚úÖ Login successful!');
                } else {
                    errorEl.textContent = data.error || '‚ùå Invalid email or password';
                    errorEl.style.display = 'block';
                    document.getElementById('loginPassword').value = '';
                }
            } catch (error) {
                console.error('Login error:', error);
                // Fallback to client-side check if API fails
                if (email === adminCredentials.email && password === adminCredentials.password) {
                    isLoggedIn = true;
                    errorEl.style.display = 'none';
                    document.getElementById('loginModal').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    document.getElementById('mainContent').style.display = 'none';
                    document.querySelector('footer').style.display = 'none';
                    sessionStorage.setItem('adminLoggedIn', 'true');
                    loadCurrentRecipe();
                    displayAdminReviews();
                    displayOrderHistory();
                    updateAdminStats();
                    alert('‚úÖ Login successful! (Note: Email notification may not have been sent)');
                } else {
                    errorEl.textContent = '‚ùå Invalid email or password. Please check your connection.';
                    errorEl.style.display = 'block';
                    document.getElementById('loginPassword').value = '';
                }
            } finally {
                if (submitButton) {
                    submitButton.disabled = false;
                    submitButton.textContent = originalButtonText;
                }
            }
        }

        function logoutAdmin() {
            isLoggedIn = false;
            sessionStorage.removeItem('adminLoggedIn');
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            document.querySelector('footer').style.display = 'block';
            document.getElementById('loginForm').reset();
            alert('Logged out successfully');
        }

        function checkAdminAccess() {
            const params = new URLSearchParams(window.location.search);
            const isAdmin = params.get('admin') === 'true';
            const wasLoggedIn = sessionStorage.getItem('adminLoggedIn') === 'true';

            const adminPanel = document.getElementById('adminPanel');
            const mainContent = document.getElementById('mainContent');
            const loginModal = document.getElementById('loginModal');

            if (isAdmin && wasLoggedIn) {
                loginModal.style.display = 'none';
                adminPanel.style.display = 'block';
                mainContent.style.display = 'none';
                document.querySelector('footer').style.display = 'none';
                isLoggedIn = true;
                loadCurrentRecipe();
                displayAdminReviews();
                displayOrderHistory();
                updateAdminStats();
            } else if (isAdmin) {
                loginModal.style.display = 'flex';
                adminPanel.style.display = 'none';
                mainContent.style.display = 'none';
            } else {
                loginModal.style.display = 'none';
                adminPanel.style.display = 'none';
                mainContent.style.display = 'block';
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAdminAccess();
        });



        // ===== RELIABLE PDF GENERATION WITH HTML2PDF =====
        async function generateAndDownloadPDF() {
            if (!currentOrder) {
                alert('‚ùå No order found');
                return;
            }

            try {
                console.log('üìÑ Starting PDF generation for order:', currentOrder.orderId);

                // Get the full HTML content
                const fullHTML = generatePDFContent();
                
                // Extract body content and styles from the HTML string
                const parser = new DOMParser();
                const doc = parser.parseFromString(fullHTML, 'text/html');
                const bodyContent = doc.body.innerHTML;
                const styles = doc.head.querySelector('style')?.innerHTML || '';

                // Create a temporary visible container for PDF generation
                const pdfContainer = document.createElement('div');
                pdfContainer.id = 'pdf-temp-container';
                pdfContainer.style.width = '210mm';
                pdfContainer.style.minHeight = '297mm';
                pdfContainer.style.padding = '20px';
                pdfContainer.style.fontFamily = 'Arial, sans-serif';
                pdfContainer.style.background = 'white';
                pdfContainer.style.color = '#333';
                pdfContainer.style.position = 'fixed';
                pdfContainer.style.top = '0';
                pdfContainer.style.left = '0';
                pdfContainer.style.zIndex = '-1';
                pdfContainer.style.opacity = '0';
                
                // Add styles to container
                if (styles) {
                    const styleElement = document.createElement('style');
                    styleElement.textContent = styles;
                    pdfContainer.appendChild(styleElement);
                }
                
                // Add body content directly
                pdfContainer.innerHTML += bodyContent;
                document.body.appendChild(pdfContainer);
                
                // Wait a moment for rendering
                await new Promise(resolve => setTimeout(resolve, 300));

                // PDF options
                const options = {
                    margin: [10, 10, 10, 10],
                    filename: 'Maadhuri_Order_' + currentOrder.orderId + '.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2, 
                        logging: false, 
                        useCORS: true,
                        backgroundColor: '#ffffff',
                        windowWidth: 794,
                        windowHeight: 1123
                    },
                    jsPDF: { 
                        orientation: 'portrait', 
                        unit: 'mm', 
                        format: 'a4',
                        compress: true
                    }
                };
                
                // Generate PDF using html2pdf library
                await html2pdf()
                    .set(options)
                    .from(pdfContainer)
                    .save();
                
                console.log('‚úÖ PDF generated and downloaded successfully');
                // Reset cart after PDF download
                cart = [];
                updateCartCount();
                if (document.body.contains(pdfContainer)) {
                    document.body.removeChild(pdfContainer);
                }

            } catch(error) {
                console.error('‚ùå PDF Error:', error);
                alert('‚ùå An error occurred while generating the PDF. Please try again.');
                const pdfContainer = document.getElementById('pdf-temp-container');
                if (pdfContainer && document.body.contains(pdfContainer)) {
                    document.body.removeChild(pdfContainer);
                }
            }
        }

        function openPrintDialog(html) {
            // Not used with html2pdf - PDF is directly downloaded
            console.log('Using html2pdf for direct download');
        }

        // Header scroll behavior - hide on scroll down, show on scroll up
        let lastScrollTop = 0;
        let navElement = null;

        window.addEventListener('DOMContentLoaded', function() {
            navElement = document.querySelector('nav');
            
            window.addEventListener('scroll', function() {
                if (!navElement) return;
                
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                if (scrollTop > lastScrollTop && scrollTop > 100) {
                    // Scrolling down - hide header
                    navElement.classList.add('hidden');
                } else {
                    // Scrolling up - show header
                    navElement.classList.remove('hidden');
                }
                
                lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
            });
        });

    </script>
</body>
</html>
